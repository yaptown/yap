Solving the problem took three years.