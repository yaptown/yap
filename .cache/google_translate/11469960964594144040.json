This is the tricky part.