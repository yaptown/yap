This problem is really complicated.